공유된 자원에 여러 프로세스가 동시에 접근하면서 문제가 발생할 수 있습니다. 이때 공유된 자원의 데이터는 한 번에 하나의 프로세스만 접근할 수 있도록 제한을 두어야합니다. ```뮤텍스(Mutex)```와 ```세마포어(Semaphore)``` 는 이를 위해 고안된 기법으로 서로 다른 방식으로 상호배제를 합니다.

<br>

## **임계 구역(Critical section)**

임계 구역은 다수의 프로세스가 데이터를 공유하며 실행되는 상황에서 각 프로세스가 공유 자원에 접근하는 코드 블록을 의미합니다. 공유 데이터를 여러 프로세스가 동시에 접근할 때 잘못된 결과를 만들 수 있기 때문에, 한 프로세스가 임계 구역을 수행할 때는 다른 프로세스가 접근하지 못하도록 해야 합니다.

<br>

## **뮤텍스(Mutex)**

```
한 쓰레드, 프로세스에 의해 소유될 수 있는 Key를 기반으로 한 상호배제기법
```

뮤텍스는 공유된 자원의 데이터 혹은 임계영역(Critical Section) 등에 하나의 Process 혹은 Thread가 접근하는 것을 막아 줍니다. (동기화 대상이 하나)

![뮤텍스2](https://user-images.githubusercontent.com/67899393/196937012-c2d04b84-2c4f-4dba-8807-cc36a65460ec.png)

한 프로세스에 의해 소유될 수 있는 Key를 기반으로 한 상호배제 기법이고 Key에 해당하는 어떤 객체(Object)가 있으며, 이 객체를 소유한 스레드/프로세스만이 공유자원에 접근할 수 있습니다. Locking 메커니즘으로 오직 하나의 쓰레드만이 동일한 시점에 뮤텍스를 얻어 임계 영역(Critical Section)에 들어올 수 있다. 그리고 오직 이 쓰레드만이 임계 영역에서 나갈 때 뮤텍스를 해제할 수 있습니다.

![뮤텍스](https://user-images.githubusercontent.com/67899393/196937073-394a615f-5c6b-4832-b44a-11b552abc4ac.jpg)

<br>

## **세마포어(Semaphore)**

```
현재 공유자원에 접근할 수 있는 쓰레드, 프로세스의 수를 나타내는 값을 두어 상호배제를 달성하는 기법
```

세마포어는 공유된 자원의 데이터 혹은 임계영역(Critical Section) 등에 여러 Process 혹은 Thread가 접근하는 것을 막아 줍니다. (동기화 대상이 하나 이상)

![세마포어2](https://user-images.githubusercontent.com/67899393/196937087-cf09f941-7a8d-4ea6-b5b3-71e49e846130.png)

사용하고 있는 스레드/프로세스의 수를 공통으로 관리하는 하나의 값을 이용해 상호배제를 달성합니다. 공유 자원에 접근할 수 있는 프로세스의 최대 허용치만큼 동시에 사용자가 접근할 수 있으며, 각 프로세스는 세마포어의 값을 확인하고 변경할 수 있습니다.

![세마포어](https://user-images.githubusercontent.com/67899393/196937080-76bf026b-9a9d-485b-97cb-d15032f55c88.jpg)

  
  
세마포어는 크게 Counting Semaphores, Binary Semaphore 2종류가 있습니다. 카운팅 세마포어는 세마포어의 카운트가 양의 정수값을 가지며, 설정한 값만큼 쓰레드를 허용하고 그 이상의 쓰레드가 자원에 접근하면 락이 실행됩니다. 바이너리 세마포어는 세마포어의 카운트가 1이며 Mutex처럼 사용될 수 있습니다.(뮤텍스는 절대로 세마포어처럼 사용될 수 없다.)

<br>

## **뮤텍스와 세마포어 차이점**

-   Mutex는 동기화 대상이 오직 1개일 때 사용하며, Semaphore는 동기화 대상이 1개 이상일 때 사용합니다.
-   Mutex는 자원을 소유할 수 있고, 책임을 가지는 반면 Semaphore는 자원 소유가 불가합니다.
-   Mutex는 상태가 0, 1 뿐이므로 Lock을 가질 수 있고, 소유하고 있는 스레드만이 이 Mutex를 해제할 수 있습니다. 반면 Semaphore는 Semaphore를 소유하지 않는 스레드가 Semaphore를 해제할 수 있습니다.
-   Semaphore는 시스템 범위에 걸쳐 있고, 파일 시스템 상의 파일로 존재합니다. 반면, Mutex는 프로세스의 범위를 가지며 프로세스 종료될 때 자동으로 Clean up 됩니다.
